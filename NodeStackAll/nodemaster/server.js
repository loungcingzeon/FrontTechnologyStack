let http = require('http');let fs = require('fs');let url = require('url');let querystring = require('querystring');// 重构function startServer(route, handle){  let onRequest = function(request, response){    // 取url地址的参数    let pathname = url.parse(request.url).pathname;    console.log('Request received ' + pathname);    let data = [];    request.on('error', function(err){      console.error(err);    }).on('data', function(chunk){      //data += chunk;      data.push(chunk);    }).on('end', function(){      if(request.method === 'POST'){        if(data.length > 1e6){          request.connection.destroy();        }        data = Buffer.concat(data).toString();        route(handle, pathname, response, querystring.parse(data));      }else{        let params = url.parse(request.url, true).query;        route(handle, pathname, response, params);      }    });    // 这只有 get 方法才能取到值的，post方法是取不到的值的    /*let params = url.parse(request.url, true).query;    route(handle, pathname, response, params);*/  };  let server = http.createServer(onRequest);  server.listen(8081);  console.log('Server started on localhost port 8081');};module.exports.startServer = startServer;